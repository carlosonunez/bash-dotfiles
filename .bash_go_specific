GO_SRC_FOLDER=$HOME/src/go

# Install Go if needed
# ====================
which go 2>&1 >/dev/null || {
    echo "Go is not installed. Let's fix that."
    [[ "`uname`" == "Darwin" ]] && { 
        brew install go --cross-compile-daemon; 
    } || {
        sudo apt-get install golang
    }
}

# Set up the Golang workspace if non-existent
# ============================================
[[ ! -d ~/source/go ]] && {
    [[ -d $GO_SRC_FOLDER ]] || mkdir $GO_SRC_FOLDER
    for dir in bin src pkg; do
      [[ -d $GO_SRC_FOLDER/$dir ]] || {
        pushd $GO_SRC_FOLDER
        mkdir $dir
        popd
      }
    done
}

# Set GOPATH if unset
# ===================
export GOPATH=$HOME/go
export GOROOT=/usr/local/opt/go/libexec
export PATH=$PATH:$GOPATH/bin:$GOROOT/bin

# Setup vim-go
# =============
[[ ! -d ~/.vim/bundle/vim-go ]] && {
    echo "Installing vim-go (a better vim plugin for Golang)"
    git clone https://github.com/fatih/vim-go.git ~/.vim/bundle/vim-go
}
