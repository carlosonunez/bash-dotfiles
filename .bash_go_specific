# Install Go if needed
# ====================
case "$(get_os_type)" in
	"Darwin")
    brew install go --cross-compile-daemon
    ;;
  "Ubuntu")
		sudo add-apt-repository ppa:longsleep/golang-backports
		sudo apt-get update
		sudo apt-get install golang-go
    ;;
  *)
    echo "ERROR: This OS is not supported." >&2
    exit 1
    ;;
esac

# Set up the Golang workspace if non-existent
# ============================================
if [ ! -d "${GO_SRC_FOLDER}" ]
then
	echo "INFO: Creating workspace in ${GO_SRC_FOLDER}"
	mkdir -p "${GO_SRC_FOLDER}/{bin,src,pkg}"
fi

# Set GOPATH if unset
# ===================
echo "INFO: Exporting paths"
export GOPATH="${GO_SRC_FOLDER}"
export GOROOT=/usr/local/opt/go/libexec
export PATH=$PATH:$GOPATH/bin:$GOROOT/bin

# Setup vim-go
# =============
if [[ ! -d ~/.vim/bundle/vim-go ]]
then
  echo "Installing vim-go (a better vim plugin for Golang)"
  git clone https://github.com/fatih/vim-go.git ~/.vim/bundle/vim-go
fi
