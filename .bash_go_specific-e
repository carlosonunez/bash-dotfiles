GO_SRC_FOLDER=$HOME/src/go

# Install Go if needed
# ====================
LATEST_GOLANG_LINUX_VERSION="go1.8.linux-amd64"
if [[ "$(get_os_type)" == "Darwin" ]]
then
  go_binary_path="/usr/local/bin/go"
else
  go_binary_path="/usr/local/go/bin/go"
fi
[[ ! -f $go_binary_path ]] && {
  printf "${BYellow}INFO:${NC} Installing golang (sudo required; enter your password when prompted)\n"
  case "$(get_os_type)" in
    "Darwin")
      brew install go --cross-compile-daemon
      ;;
    "Ubuntu"|"Debian")
      sudo apt-get -y update
      sudo curl -O "https://storage.googleapis.com/golang/${LATEST_GOLANG_LINUX_VERSION}.tar.gz"
      printf "${BYellow}INFO:${NC} Extracting go\n"
      sudo sh -c "[ ! -d /usr/local/go ] && mkdir -p /usr/local/go"
      sudo tar -xf "${LATEST_GOLANG_LINUX_VERSION}.tar.gz" -C "/usr/local/go"
      sudo rm -rf "${LATEST_GOLANG_LINUX_VERSION}.tar.gz"
      ;;
    *)
      printf "${BYellow}INFO: No installation subroutine provided for \
        OS $(get_os_type). Assuming package 'golang-go'. Your version might be out of date.\n"
      install_application "golang-go"
      ;;
  esac
}

# Set up the Golang workspace if non-existent
# ============================================
[[ ! -d ~/src/go ]] && {
  [[ -d $GO_SRC_FOLDER ]] || mkdir $GO_SRC_FOLDER
    for dir in bin src pkg; do
      [[ -d $GO_SRC_FOLDER/$dir ]] || {
        pushd $GO_SRC_FOLDER
          mkdir $dir
          popd
      }
  done
}

# Set GOPATH if unset
# ===================
export GOPATH="/usr/local/go"
export PATH="$PATH:$GOPATH/bin"
go_work_directory="$HOME/src/go"
mkdir -p "${go_work_directory}"
export GOPATH="${go_work_directory}"
for i in src pkg bin; do mkdir -p "${go_work_directory}/${i}"; done

# Setup vim-go
# =============
[[ ! -d ~/.vim/bundle/vim-go ]] && {
  echo "Installing vim-go (a better vim plugin for Golang)"
    git clone https://github.com/fatih/vim-go.git ~/.vim/bundle/vim-go
}


